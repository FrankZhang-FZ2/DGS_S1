rotate = "oblimin",
fm="ml")
EFA_7M_f6
print(EFA_7M_f6 $loadings, cutoff = 0.3)
##need to check 38 and 71 and see if they fit the model. IRT may be helpful here.
DGS%>%
ggplot()+
geom_bar(aes(x=DGS_38, alpha = 0.1))+
geom_bar(aes(x=DGS_67))
#visualization
fa.diagram(EFA_7M_f6)
#select items for this factor
DGS_7M_f7 <- DGS%>%
select(c(DGS_2,DGS_5,DGS_11,DGS_13,DGS_48,DGS_66,DGS_73)) #remove 47 due to low loading in the 7 factor model and low conceptual relevancy.
#run for concise model
DGS_7M_f7 <- DGS%>%
select(c(DGS_2,DGS_11,DGS_13,DGS_73)) # recommend one factor for the concise version
cor.plot(DGS_7M_f7)
##Kaiser Criterion
ev<- eigen(cor(DGS_7M_f7))
ev$values
sum(ev$values > 1)
sum(ev$values > .7)
#scree plot and parallel analysis
scree(DGS_7M_f7, pc=FALSE)
fa.parallel(DGS_7M_f7,
fm="ml",
fa="fa")
#EFA
EFA_7M_f7 <- fa(DGS_7M_f7,
nfactors = 1,
rotate = "oblimin",
fm="ml")
EFA_7M_f7
print(EFA_7M_f7$loadings, cutoff = 0.3)
#visualization
fa.diagram(EFA_7M_f7)
DGS_7model_1 <- DGS %>%
select(c(DGS_4,DGS_12,DGS_15,DGS_17,DGS_19,DGS_22,DGS_32,DGS_33,DGS_49,DGS_56,DGS_60,DGS_75))
DGS_7model_2 <- DGS %>%
select(c(DGS_5,DGS_10,DGS_26,DGS_41,DGS_54,DGS_69,DGS_72))
DGS_7model_3 <- DGS %>%
select(c(DGS_9, DGS_27,DGS_29,DGS_46,DGS_51,DGS_52))
DGS_7model_4 <- DGS %>%
select(c(DGS_1,DGS_21,DGS_44,DGS_65))
DGS_7model_5 <- DGS %>%
select(c(DGS_20,DGS_28,DGS_35,DGS_48,DGS_68))
DGS_7model_6 <- DGS %>%
select(c(DGS_6,DGS_38,DGS_39,DGS_45,DGS_67,DGS_70,DGS_71))
DGS_7model_7 <- DGS %>%
select(c(DGS_2,DGS_11,DGS_73,DGS_13))
#6 factors model without behavioral items
DGS_6model_1 <- DGS %>%
select(c(DGS_4,DGS_12,DGS_15,DGS_17,DGS_18,DGS_19,DGS_22,DGS_30,DGS_32,DGS_33,DGS_34,DGS_36,DGS_37,DGS_49,DGS_57,DGS_58,DGS_60,DGS_61,DGS_63,DGS_74,DGS_74))
DGS_6model_2 <- DGS %>%
select(c(DGS_5,DGS_10,DGS_26,DGS_41,DGS_54,DGS_69,DGS_72))
DGS_6model_3 <- DGS %>%
select(c(DGS_9,DGS_20,DGS_27,DGS_29,DGS_46,DGS_52))
DGS_6model_4 <- DGS %>%
select(c(DGS_2,DGS_11,DGS_28,DGS_35,DGS_48,DGS_68))
DGS_6model_5 <- DGS %>%
select(c(DGS_1,DGS_21,DGS_44,DGS_65))
DGS_6model_6 <- DGS %>%
select(c(DGS_6,DGS_38,DGS_39,DGS_45,DGS_67,DGS_70,DGS_71))
#visualization
corPlot(DGS_7model_1)
corPlot(DGS_7model_2)
corPlot(DGS_7model_3)
corPlot(DGS_7model_4)
corPlot(DGS_7model_5)
corPlot(DGS_7model_6)
corPlot(DGS_7model_7)
cor(DGS_beh)
# 6 factors
corPlot(DGS_6model_1)
corPlot(DGS_6model_2)
corPlot(DGS_6model_3)
corPlot(DGS_6model_4)
corPlot(DGS_6model_5)
corPlot(DGS_6model_6)
## make a correlation matrix to screen for overlapping items
DGS_IRT_1 = mirt(data = DGS_7model_1,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT_1)
coef(DGS_IRT_1, IRTpars = T)
#itemplot(DGS_IRT_1, 1, type = "trace")
itemplot(DGS_IRT_1, 1, type = "info")
plot(DGS_IRT_1, type = "trace")
plot(DGS_IRT_1, type = "info")
plot(DGS_IRT_1) #expected score curve
#person fit
#fscores(DGS_IRT_1) #factor score for each participants
#mirt::itemfit(DGS_IRT_1)
#mirt::personfit(DGS_IRT_1)
DGS_IRT_2 = mirt(data = DGS_7model_2,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT_2)
coef(DGS_IRT_2, IRTpars = T)
#itemplot(DGS_IRT_2, 5, type = "trace")
itemplot(DGS_IRT_2, 5, type = "info")
plot(DGS_IRT_2, type = "trace")
plot(DGS_IRT_2, type = "info")
plot(DGS_IRT_2) #expected score curve
#person fit
#fscores(DGS_IRT_2) #factor score for each participants
#mirt::itemfit(DGS_IRT_2)
#mirt::personfit(DGS_IRT_2)
DGS_IRT_3 = mirt(data = DGS_7model_3,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT_3)
coef(DGS_IRT_3, IRTpars = T)
#itemplot(DGS_IRT_3, 1, type = "trace")
itemplot(DGS_IRT_3, 3, type = "info")
plot(DGS_IRT_3, type = "trace")
plot(DGS_IRT_3, type = "info")
plot(DGS_IRT_3) #expected score curve
#person fit
#fscores(DGS_IRT_3) #factor score for each participants
#mirt::itemfit(DGS_IRT_3)
#mirt::personfit(DGS_IRT_3)
DGS_IRT_4 = mirt(data = DGS_7model_4,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT_4)
coef(DGS_IRT_4, IRTpars = T)
#itemplot(DGS_IRT_4, 5, type = "trace")
itemplot(DGS_IRT_4, 4, type = "info")
plot(DGS_IRT_4, type = "trace")
plot(DGS_IRT_4, type = "info")
plot(DGS_IRT_4) #expected score curve
#person fit
#fscores(DGS_IRT_4) #factor score for each participants
#mirt::itemfit(DGS_IRT_4)
#mirt::personfit(DGS_IRT_4)
DGS_IRT_5 = mirt(data = DGS_7model_5,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT_5)
coef(DGS_IRT_5, IRTpars = T)
#itemplot(DGS_IRT_5, 5, type = "trace")
itemplot(DGS_IRT_5, 3, type = "info")
plot(DGS_IRT_5, type = "trace")
plot(DGS_IRT_5, type = "info")
plot(DGS_IRT_5) #expected score curve
#person fit
#fscores(DGS_IRT_5) #factor score for each participants
#mirt::itemfit(DGS_IRT_5)
#mirt::personfit(DGS_IRT_5)
DGS_IRT_6 = mirt(data = DGS_7model_6,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT_6)
coef(DGS_IRT_6, IRTpars = T)
#itemplot(DGS_IRT_6, 5, type = "trace")
itemplot(DGS_IRT_6, 1, type = "info")
plot(DGS_IRT_6, type = "trace")
plot(DGS_IRT_6, type = "info")
plot(DGS_IRT_6) #expected score curve
#person fit
#fscores(DGS_IRT_6) #factor score for each participants
#mirt::itemfit(DGS_IRT_6)
#mirt::personfit(DGS_IRT_6)
DGS_IRT_7 = mirt(data = DGS_7model_7,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT_7)
coef(DGS_IRT_7, IRTpars = T)
#itemplot(DGS_IRT_7, 1, type = "trace")
itemplot(DGS_IRT_7, 1, type = "info")
plot(DGS_IRT_7, type = "trace")
plot(DGS_IRT_7, type = "info")
plot(DGS_IRT_7) #expected score curve
#person fit
#fscores(DGS_IRT_7) #factor score for each participants
#mirt::itemfit(DGS_IRT_7)
#mirt::personfit(DGS_IRT_7)
DGS_IRT6_1 = mirt(data = DGS_6model_1,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_1)
coef(DGS_IRT6_1, IRTpars = T)
#itemplot(DGS_IRT6_1, 1, type = "trace")
itemplot(DGS_IRT6_1, 1, type = "info")
plot(DGS_IRT6_1, type = "trace")
plot(DGS_IRT6_1, type = "info")
##with factor scores
DGSf_HEXACO <- data %>%
select(c(HEXACO_C,starts_with("DGS_6C_"),DGS_donation,DGS_vol))
#6 factors model without behavioral items
DGS_6model_1 <- DGS %>%
select(c(DGS_12,DGS_15,DGS_17,DGS_18,DGS_19,DGS_30,DGS_32,DGS_33,DGS_34,DGS_36,DGS_37,DGS_49,DGS_57,DGS_58,DGS_60,DGS_61,DGS_63,DGS_74,DGS_74))
DGS_6model_2 <- DGS %>%
select(c(DGS_5,DGS_10,DGS_26,DGS_41,DGS_54,DGS_69,DGS_72))
DGS_6model_3 <- DGS %>%
select(c(DGS_9,DGS_27,DGS_29,DGS_46,DGS_52))
DGS_6model_4 <- DGS %>%
select(c(DGS_28,DGS_35,DGS_48,DGS_68))
DGS_6model_5 <- DGS %>%
select(c(DGS_21,DGS_44,DGS_65))
DGS_6model_6 <- DGS %>%
select(c(DGS_6,DGS_38,DGS_39,DGS_67,DGS_70,DGS_71))
#construct behavioral estimates
DGS_beh <- data%>%
select(c(DGS_13,DGS_73))
data$DGS_beh <- rowSums(DGS_beh)/ncol(DGS_beh)
data$DGS_donation <- data %>%
select(DGS_13)
data$DGS_vol <- data %>%
select(DGS_73)
##with factor scores
DGSf_HEXACO <- data %>%
select(c(HEXACO_C,starts_with("DGS_6C_"),DGS_donation,DGS_vol))
cor.plot(DGSf_HEXACO)
summary(m_DGS_beh)
cor.plot(DGSf_HEXACO )
data$DGS_6C_1 <- rowSums(DGS_6model_1)/ncol(DGS_6model_1)
data$DGS_6C_2 <- rowSums(DGS_6model_2)/ncol(DGS_6model_2)
data$DGS_6C_3 <- rowSums(DGS_6model_3)/ncol(DGS_6model_3)
data$DGS_6C_4 <- rowSums(DGS_6model_4)/ncol(DGS_6model_4)
data$DGS_6C_5 <- rowSums(DGS_6model_5)/ncol(DGS_6model_5)
data$DGS_6C_6 <- rowSums(DGS_6model_6)/ncol(DGS_6model_6)
##with factor scores
DGSf_HEXACO <- data %>%
select(c(HEXACO_C,starts_with("DGS_6C_"),DGS_donation,DGS_vol))
cor.plot(DGSf_HEXACO)
m_DGS_beh <- lm (
DGS_13 ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
summary(m_DGS_beh)
cor.plot(DGSf_HEXACO)
m_DGS_beh <- lm (
DGS_13 ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
summary(m_DGS_beh)
0.3196^1/2
0.3196^2
0.3196^(1/2)
m_DGS_beh <- lm (
DGS_13 ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
summary(m_DGS_beh)
DGS_IRT6_1 = mirt(data = DGS_6model_1,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_1)
coef(DGS_IRT6_1, IRTpars = T)
#itemplot(DGS_IRT6_1, 1, type = "trace")
itemplot(DGS_IRT6_1, 1, type = "info")
plot(DGS_IRT6_1, type = "trace")
plot(DGS_IRT6_1, type = "info")
plot(DGS_IRT6_1) #expected score curve
##recommend taking out 4 and 22
DGS_6model_1 <- DGS_6model_1%>%
select(!c(DGS_4,DGS_22))
summary(DGS_IRT6_1)
plot(DGS_IRT6_1, type = "trace")
plot(DGS_IRT6_1, type = "info")
plot(DGS_IRT6_2, type = "info")
plot(DGS_IRT6_3, type = "info")
DGS_IRT6_3 = mirt(data = DGS_6model_3,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
plot(DGS_IRT6_3, type = "info")
DGS_IRT6 = mirt(data = DGS_fit_6C,
model = 6, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
DGS_IRT6 = mirt(data = DGS_fit_6C,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
plot(DGS_IRT6, type = "info")
plot(DGS_IRT6_1, type = "info")
plot(DGS_IRT6_4, type = "info")
DGS_IRT6_4 = mirt(data = DGS_6model_4,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
plot(DGS_IRT6_4, type = "info")
coef(DGS_IRT6_2, IRTpars = T)
plot(DGS_IRT6_2, type = "trace")
plot(DGS_IRT6_2, type = "info")
plot(DGS_IRT6_2, type = "trace")
plot(DGS_IRT6, type = "trace")
plot(DGS_IRT6, type = "info")
plot(DGS_IRT6_5, type = "info")
plot(DGS_IRT6_6, type = "info")
DGS_IRT6_6 = mirt(data = DGS_6model_6,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
plot(DGS_IRT6_6, type = "info")
# try to trim out behavioral items and create 6 factors
DGS_fit_6C <- DGS %>%
select(c(
DGS_4,DGS_12,DGS_15,DGS_17,DGS_18,DGS_19,DGS_22,DGS_30,DGS_32,DGS_33,DGS_34,DGS_36,DGS_37,DGS_49,DGS_57,DGS_58,DGS_60,DGS_61,DGS_63,DGS_74,DGS_74,
DGS_5,DGS_10,DGS_26,DGS_41,DGS_54,DGS_69,DGS_72,
DGS_9,DGS_20,DGS_27,DGS_29,DGS_46,DGS_52,
DGS_2,DGS_11,DGS_28,DGS_35,DGS_48,DGS_68,
DGS_1,DGS_21,DGS_44,DGS_65,
DGS_6,DGS_38,DGS_39,DGS_45,DGS_67,DGS_70,DGS_71
))
EFA_fit_6 <- fa(DGS_fit_6,
nfactors = 6,
rotate = "oblimin",
fm="ml")
# try to trim out behavioral items and create 6 factors
DGS_fit_6 <- DGS %>%
select(!c(DGS_13,DGS_73,DGS_16,DGS_40,DGS_42,DGS_43))
EFA_fit_6 <- fa(DGS_fit_6,
nfactors = 6,
rotate = "oblimin",
fm="ml")
EFA_fit_6
print(EFA_fit_6$loadings, cutoff = 0.4)
print(EFA_fit_6$loadings, cutoff = 0.4)
print(EFA_fit_6$loadings)
DGS_beh <- data%>%
select(c(DGS_13,DGS_73))
EFA_fit_6$rms  # Root mean square of the residuals (lower the better)
EFA_fit_6$RMSEA # root mean squared error of approximation (lower the better)
EFA_fit_6$RMSEA # root mean squared error of approximation (lower the better)
EFA_fit_6$TLI  # tucker lewis index
1- ((EFA_fit_6$STATISTIC-EFA_fit_6$dof)/
(EFA_fit_6$null.chisq-EFA_fit_6$null.dof))  #CFI
# try to trim out behavioral items and create 6 factors
DGS_fit_6C <- DGS %>%
select(c(
DGS_4,DGS_12,DGS_15,DGS_17,DGS_18,DGS_19,DGS_22,DGS_30,DGS_32,DGS_33,DGS_34,DGS_36,DGS_37,DGS_49,DGS_57,DGS_58,DGS_60,DGS_61,DGS_63,DGS_74,DGS_74,
DGS_5,DGS_10,DGS_26,DGS_41,DGS_54,DGS_69,DGS_72,
DGS_9,DGS_20,DGS_27,DGS_29,DGS_46,DGS_52,
DGS_2,DGS_11,DGS_28,DGS_35,DGS_48,DGS_68,
DGS_1,DGS_21,DGS_44,DGS_65,
DGS_6,DGS_38,DGS_39,DGS_45,DGS_67,DGS_70,DGS_71
))
# 64 59 47(poor conceptual fit) 55(mixed conceptual fit) 23(poor conceptual fit)
EFA_fit_6C <- fa(DGS_fit_6C,
nfactors = 6,
rotate = "oblimin",
fm="ml")
EFA_fit_6C
#fit
EFA_fit_6C$rms  # Root mean square of the residuals (lower the better)
EFA_fit_6C$RMSEA # root mean squared error of approximation (lower the better)
EFA_fit_6C$TLI  # tucker lewis index
1- ((EFA_fit_6C$STATISTIC-EFA_fit_6C$dof)/
(EFA_fit_6C$null.chisq-EFA_fit_6C$null.dof))  #CFI
EFA_fit_6C$RMSEA # root mean squared error of approximation (lower the better)
# try to trim out behavioral items and create 6 factors
DGS_fit_6C <- DGS %>%
select(c(
DGS_4,DGS_12,DGS_15,DGS_17,DGS_18,DGS_19,DGS_22,DGS_30,DGS_32,DGS_33,DGS_34,DGS_36,DGS_37,DGS_49,DGS_57,DGS_58,DGS_60,DGS_61,DGS_63,DGS_74,DGS_74,
DGS_5,DGS_10,DGS_26,DGS_41,DGS_54,DGS_69,DGS_72,
DGS_9,DGS_20,DGS_27,DGS_29,DGS_46,DGS_52,
DGS_2,DGS_11,DGS_28,DGS_35,DGS_48,DGS_68,
DGS_1,DGS_21,DGS_44,DGS_65,
DGS_6,DGS_38,DGS_39,DGS_45,DGS_67,DGS_70,DGS_71
))
# 64 59 47(poor conceptual fit) 55(mixed conceptual fit) 23(poor conceptual fit)
EFA_fit_6C <- fa(DGS_fit_6C,
nfactors = 6,
rotate = "oblimin",
fm="ml")
EFA_fit_6C
cor.plot(DGSf_HEXACO)
summary(m_DGS_beh)
m_DGS_beh <- lm (
DGS_73 ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
summary(m_DGS_beh)
m_DGS_beh <- lm (
DGS_13 ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
0.3196^(1/2)
summary(m_DGS_beh)
cor.plot(DGSf_HEXACO)
m_DGS_beh <- lm (
DGS_donation ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
class(data$DGS_donation)
data$DGS_donation <- apply(data$DGS_donation, 2, as.numeric)
data$DGS_vol <- apply(data$DGS_vol, 2, as.numeric)
m_DGS_beh <- lm (
DGS_donation ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
summary(m_DGS_beh)
m_DGS_beh <- lm (
DGS_vol ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
summary(m_DGS_vol)
summary(m_DGS_beh)
cor.plot(DGSf_HEXACO)
psych::omega(HEXACO_C, nfactors = 4) # alpha = 0.82
DGS_IRT6_1 = mirt(data = DGS_6model_1,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_1)
#6 factors model without behavioral items
DGS_6model_1 <- DGS %>%
select(c(DGS_4,DGS_12,DGS_15,DGS_17,DGS_18,DGS_19,DGS_22,DGS_30,DGS_32,DGS_33,DGS_34,DGS_36,DGS_37,DGS_49,DGS_57,DGS_58,DGS_60,DGS_61,DGS_63,DGS_74,DGS_75))
DGS_IRT6_1 = mirt(data = DGS_6model_1,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_1)
DGS_IRT6_2 = mirt(data = DGS_6model_2,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_2)
DGS_IRT6_3 = mirt(data = DGS_6model_3,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_3)
DGS_IRT6_4 = mirt(data = DGS_6model_4,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_4)
DGS_IRT6_5 = mirt(data = DGS_6model_5,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_5)
DGS_IRT6_6 = mirt(data = DGS_6model_6,
model = 1, #this is for one factor
itemtype = "gpcmIRT" #generalized partial credit model
)
summary(DGS_IRT6_6)
m_DGS_beh <- lm (
DGS_donation ~
DGS_6C_1 +
DGS_6C_2 +
DGS_6C_4 +
DGS_6C_3 +
DGS_6C_5 +
DGS_6C_6,
data= data
)
summary(m_DGS_beh)
cor.plot(DGSf_HEXACO)
